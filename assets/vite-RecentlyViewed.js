import{r as h,j as t}from"./vite-app.js";const N=async(e,a)=>await(await fetch(window.Shopify.routes.root+`recommendations/products.json?product_id=${e}&limit=${a}&intent=related`)).json(),v=()=>{const[e,a]=h.useState([]);return h.useEffect(()=>{const r=async(n,s)=>await N(n,s);(async()=>{const n=localStorage.getItem("jgRecentlyViewedData");if(n){let s=Object.values(JSON.parse(n));if(s=s.sort((i,o)=>o.time-i.time),(s==null?void 0:s.length)<4){const i=await r(s[0].id,10),o=[...s.sort((d,u)=>u.time-d.time)];let l=0;for(;o.length<4&&i.products.length;){const d=i.products.filter(y=>!s.find(f=>f.id===y.id));if(d.length===0||!d[l])break;const{id:u,title:m,media:p,handle:j,price:g,variants:x}=d[l],w={id:u,title:m,media:p,handle:j,price:g,variants:x};o.push(w),l++}a(o)}else a(s)}})()},[]),e},R=async e=>{const a=document.querySelector("cart-drawer"),c=await(async()=>{try{return(await fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:e,quantity:1}],sections:a.getSectionsToRender().map(s=>s.id)})})).json()}catch(n){console.error(n)}})();a.renderContents(c)},_=({variantId:e,buttonBackgroundColor:a})=>t.jsx("button",{style:{backgroundColor:a},className:"button",onClick:()=>R(e),children:"Add to cart"}),C=({price:e})=>t.jsxs("div",{className:"price",children:["Â£",e/100," GBP"]}),b=({product:{id:e,title:a,media:r,handle:c,price:n,variants:s},buttonBackgroundColor:i})=>{var o,l,d;return t.jsx("li",{className:"grid__item scroll-trigger animate--slide-in",children:t.jsx("div",{className:"card-wrapper product-card-wrapper underline-links-hover",children:t.jsxs("div",{className:"card card--standard card--media",children:[t.jsx("img",{src:`${r&&((o=r[0])==null?void 0:o.src)}&_width=400`,alt:r&&((l=r[0])==null?void 0:l.alt),className:"motion-reduce",loading:"lazy"}),t.jsx("div",{className:"card__content",children:t.jsxs("div",{className:"card__information",children:[t.jsx("h3",{className:"card__heading h5",children:t.jsx("a",{href:`products/${c}`,children:a})}),t.jsxs("div",{className:"card__information",children:[t.jsx("span",{className:"caption-large light"}),t.jsx(C,{price:n})]})]})}),t.jsx(_,{buttonBackgroundColor:i,variantId:(d=s[0])==null?void 0:d.id})]})})},e)},D=({padding:e,rvData:a,buttonBackgroundColor:r})=>t.jsx("ul",{style:{padding:`${e}px`},className:"grid product-grid contains-card contains-card--product contains-card--standard grid--4-col-desktop grid--2-col-tablet-down",children:a.map(c=>t.jsx(b,{buttonBackgroundColor:r,product:c},c.id))}),k=({padding:e,button_background_color:a,text_color:r,title:c})=>{const n=v();return n.length?t.jsxs("div",{className:"page-width-desktop",children:[t.jsx("h2",{style:{color:r},children:c}),t.jsx(D,{buttonBackgroundColor:a,padding:e,rvData:n})]}):null};export{k as default};
